# 이벤트 루프

자바스크립트는 `싱글 스레드`로 동작한다

- 하나의 작업이 종료될때까지 다른 작업은 blocking된다

## 프로세스

프로세스란, 프로그램의 상태가 메모리상에 실행되는 작업단위.

스레드란, 하나의 프로세스 내부에서 존재하는 작은 실행단위.

- 스레드 끼리는 메모리를 공유할수있어 동시수행이 가능하다
- 멀티스레딩 같은 자원에 대해 여러번 접근이 가능해 프로그래밍 처리가 복잡하다
- 또한 하나의 스레드에 문제가 생기면 관련된 스레드에도 문제가 생길 수 있다.

자바스크립트는 원래 경고창, 폼, 버튼이미지 등 간단한 작업을 목적으로 만들어진 언어이므로 싱글스레드로 만들어졌다.
따라서 자바스크립트는 `동기`적으로 동작한다.

## 비동기

비동기란, 요청즉시 결과가 주어지지않고, 동시다발적으로 실행가능하다.

## 이벤트 루프

자바스크립트 런타임 외부에서 자바스크립트의 비동기 실행을 돕기위해 만들어진 장치.

### 호출스택 (Call Stack)

자바스크립트에서 수행할 코드나 함수를 순차적으로 담아두는 Stack.

### Task Queue

> 자료구조의 `Queue`와 다르게 FIFO 형식으로 동작하진 않는다.

태스크 큐란, 실행해야할 task의 집합으로 아래와 같은 순서로 우선순위를 가진다

`마이크로 태스크큐 > 렌더링 > 매크로 태스크 큐`

#### Macro Task Queue

- promise의 then문
- 렌더링이 끝나고 실행됨

#### Micro Task Queue

- setTimeout, setInterval
- 작업이 끝날때마다 렌더링의 기회가 생긴다

```js
function foo() {}
function bar() {}
function hello() {}

setTimeout(foo, 0);

Promise.resolve().then(bar).then(hello);

// bar -> hello ->foo
```

즉, Micro Task Queue는 렌더링보다 우선순위가 높기때문에 렌더링에 영향을 끼칠 수 있다.

### 이벤트 루프

호츨 스택이 비어있는지 여부를 확인하는것으로 아래와 같은 작업이 한 스레드에서 일어난다.

1. 호출 스택에 실행중인 코드가 있는지
2. 태스크 큐에 대기중인 함수가 있는지
